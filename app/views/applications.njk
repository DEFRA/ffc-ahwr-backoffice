{% extends './layouts/layout.njk' %}
{% import "./macros/pagination.njk" as pagination %}
{% block pageTitle %}
  {{ siteTitle }} - Applications
{% endblock %}

{% block beforeContent %}
  {{ govukBreadcrumbs({
    items: [{
      text: "Home",
      href: "/"
    }]
  })}}
{% endblock %}

{% block content %}

<div class="govuk-grid-column-full">
  <div class="govuk-grid-row">  
      <h1 class="govuk-heading-l">Applications</h1>
      <div id="heading-hint" class="govuk-hint govuk-!-margin-bottom-5">
        Select an application to edit it. <br>
        Only eligible organisations that you have access to are shown.
      </div>

      <div class="user-search-box govuk-!-width-two-thirds">
        <label class="govuk-label govuk-label--s" for="user-search">
          Search for a user by SBI number
        </label>
         
        <form method="POST">
          <input type="hidden" name="crumb" value="{{crumb}}"/>
            <input class="govuk-input" id="user-search" name="user-search" type="text" aria-describedby="user-search-hint" spellcheck="false">

            <button class="search-button" data-module="govuk-button">
                Search
            </button>
        </form>
      </div>
  </div>

  <div class="govuk-grid-row">
    
      {% if error %}
        <div class="govuk-error-summary" aria-labelledby="error-summary-title" role="alert" tabindex="-1" data-module="govuk-error-summary">
          <h2 class="govuk-error-summary__title" id="error-summary-title">There is a problem creating this applications request</h2>
        </div>
      {% endif %}

      {% if applications.length %}
        {{ govukTable({
          firstCellIsHeader: true,
          head: [
            {
              text: "Ref",
              attributes: {
                "aria-sort": "ascending"
              }
            },
            {
              text: "Business",
              attributes: {
                "aria-sort": "none"
              }
            },
            {
              text: "SBI",
              attributes: {
                "aria-sort": "ascending"
              }
            },
            {
              text: "Apply date",
              attributes: {
                "aria-sort": "none"
              },
              format: "date"
            },
            {
              text: "Claim date",
              attributes: {
                "aria-sort": "none"
              },
              format: "date"
            },
            {
              text: "Status",
              attributes: {
                "aria-sort": "none"
              }
            }
          ],
          rows: applications
        }) }}
        {{ pagination.pager(page, totalPages, applications.length, total, url) }}
        
      {% else %}
        <p class="govuk-body">No submitted applications</p>
      {% endif %}
    </div>
  </div>  

  </div>
</div>
  </div>
  
{% endblock %}